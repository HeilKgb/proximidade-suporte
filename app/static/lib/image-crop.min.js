(function(t,e){"function"==typeof define&&define.amd?define([],e):t.ImageCrop=e()})(this,function(){return function(t,e,i,h){if("string"==typeof t&&(t=document.getElementById(t)),e=e||"jpeg",i=i||.92,!t||"png"!==e&&"jpeg"!==e)return!1;var n=document.createElement("CANVAS");h=null==h?100:h;t.width,t.height;var r=0,d=0;n.width=h,n.height=h;var a={x:r,y:d,width:t.width,height:t.height},g=h,o=h*(t.width/t.height),w=0,f=(h-o)/2;t.width>t.height&&(o=h,g=h*(t.height/t.width),f=0,w=(h-g)/2);var l={x:f,y:w,width:o,height:g},u=n.getContext("2d");u.drawImage(t,a.x,a.y,a.width,a.height,l.x,l.y,l.width,l.height);for(var y=n.toDataURL("image/"+e,i),c=y.split(",")[1],m=y.split(";")[0].slice(5),p=window.atob(c),v=new ArrayBuffer(p.length),s=new Uint8Array(v),x=0;x<p.length;x++)s[x]=p.charCodeAt(x);var A=new Blob([s],{type:m});return{blob:A,dataUri:y,format:e}}});